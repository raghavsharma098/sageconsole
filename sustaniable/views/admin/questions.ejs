<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - Admin Panel</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .admin-header {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 20px rgba(220, 53, 69, 0.3);
            margin-bottom: 2rem;
        }
        
        .admin-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-logo {
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .admin-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        .admin-menu a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .admin-menu a:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .questions-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }
        
        .question-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e8f5e8;
            flex-wrap: wrap;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }
        
        .tab-button {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 600;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 0.9rem;
            flex-shrink: 0;
            min-width: fit-content;
        }
        
        .tab-button.active {
            color: #059669;
            border-bottom-color: #059669;
        }
        
        .tab-button:hover {
            color: #059669;
            background: rgba(74, 124, 89, 0.05);
            border-radius: 6px 6px 0 0;
        }
        
        @media (max-width: 768px) {
            .question-tabs {
                gap: 0.25rem;
                justify-content: flex-start;
            }
            
            .tab-button {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .tab-button i {
                display: none;
            }
        }
        
        @media (max-width: 480px) {
            .question-tabs {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem;
                border-bottom: none;
            }
            
            .tab-button {
                text-align: center;
                border: 1px solid #e8f5e8;
                border-radius: 6px;
                background: #f8fffe;
                border-bottom: 1px solid #e8f5e8;
            }
            
            .tab-button.active {
                background: #059669;
                color: white;
                border-color: #059669;
                border-bottom: 1px solid #059669;
            }
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .question-item {
            background: #f8fffe;
            border: 1px solid #e8f5e8;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .question-id {
            background: linear-gradient(135deg, #059669, #22d3ee);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            flex-shrink: 0;
            white-space: nowrap;
        }
        
        .question-text {
            flex: 1;
            font-weight: 600;
            color: #065f46;
            margin-bottom: 0.5rem;
            word-wrap: break-word;
            hyphens: auto;
            line-height: 1.4;
        }
        
        .question-meta {
            display: flex;
            gap: 1rem;
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .question-options {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e8f5e8;
        }
        
        .option-item {
            padding: 0.25rem 0;
            color: #333;
        }
        
        .question-actions {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            flex-shrink: 0;
        }
        
        .btn-action {
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @media (max-width: 768px) {
            .question-item {
                padding: 1rem;
            }
            
            .question-header {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .question-actions {
                position: static;
                justify-content: flex-end;
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #e8f5e8;
            }
            
            .question-meta {
                gap: 0.5rem;
                font-size: 0.8rem;
            }
            
            .question-text {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .question-item {
                padding: 0.75rem;
            }
            
            .question-actions {
                flex-direction: column;
                gap: 0.25rem;
            }
            
            .btn-action {
                width: 100%;
                justify-content: center;
                padding: 0.6rem;
            }
            
            .question-text {
                font-size: 0.95rem;
            }
        }
        
        .btn-edit {
            background: linear-gradient(135deg, #17a2b8, #20c997);
            color: white;
        }
        
        .btn-delete {
            background: linear-gradient(135deg, #dc3545, #e94a5a);
            color: white;
        }
        
        .btn-action:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .add-question-form {
            background: linear-gradient(135deg, #f8fffe 0%, #e8f5e8 100%);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #065f46;
            margin-bottom: 0.5rem;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e8f5e8;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
            resize: vertical;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #059669;
        }
        
        @media (max-width: 768px) {
            .add-question-form {
                padding: 1.5rem;
            }
            
            .form-control {
                font-size: 0.95rem;
                padding: 0.65rem;
            }
            
            .form-label {
                font-size: 0.95rem;
            }
        }
        
        @media (max-width: 480px) {
            .add-question-form {
                padding: 1rem;
                margin-bottom: 1.5rem;
            }
            
            .form-control {
                font-size: 0.9rem;
                padding: 0.6rem;
            }
        }
        
        .btn-add {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            border-radius: 10px 10px 0 0;
        }
        
        .modal-header h3 {
            margin: 0;
            color: #065f46;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            color: #000;
        }
        
        #editQuestionForm {
            padding: 1.5rem;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }
    </style>
</head>
<body>
    <header class="admin-header">
        <div class="container">
            <div class="admin-nav">
                <div class="admin-logo">
                    <i class="fas fa-shield-alt"></i>
                    Admin Panel
                </div>
                <div class="admin-menu">
                    <a href="/admin/dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                    <a href="/admin/questions"><i class="fas fa-question-circle"></i> Questions</a>
                    <a href="/admin/compliance-scores"><i class="fas fa-chart-bar"></i> Compliance Scores</a>
                    <a href="/admin/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <h1 style="font-size: 2.5rem; color: #065f46; margin-bottom: 2rem; font-weight: 700;">
                <i class="fas fa-question-circle"></i> Manage Assessment Questions
            </h1>

            <!-- Add New Question Form -->
            <div class="questions-section">
                <h2 style="color: #065f46; margin-bottom: 1.5rem;">
                    <i class="fas fa-plus-circle"></i> Add New Question
                </h2>
                
                <div id="alertContainer"></div>
                
                <form id="addQuestionForm" class="add-question-form">
                    <div class="form-group">
                        <label class="form-label" for="questionType">Question Type:</label>
                        <select id="questionType" name="type" class="form-control" required>
                            <option value="general">General Questions</option>
                            <option value="industry">Industry-Specific</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="industryGroup" style="display: none;">
                        <label class="form-label" for="industry">Industry:</label>
                        <select id="industry" name="industry" class="form-control">
                            <option value="textile">Textile</option>
                            <option value="chemicals">Chemicals</option>
                            <option value="pharmaceuticals">Pharmaceuticals</option>
                            <option value="automobile">Automobile</option>
                            <option value="paper-packaging">Paper and Packaging</option>
                            <option value="other-manufacturing">Other Manufacturing</option>
                            <option value="construction">Construction</option>
                            <option value="energy">Energy</option>
                            <option value="agriculture">Agriculture</option>
                            <option value="retail">Retail</option>
                            <option value="education">Education</option>
                            <option value="technology">Technology</option>
                            <option value="healthcare">Healthcare</option>
                            <option value="finance">Finance</option>
                            <option value="transportation">Transportation</option>
                            <option value="others">Others</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="questionText">Question Text:</label>
                        <textarea id="questionText" name="question" class="form-control" rows="3" required placeholder="Enter your question here..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="questionCategory">Category:</label>
                        <select id="questionCategory" name="category" class="form-control" required>
                            <option value="Environmental">Environmental</option>
                            <option value="Social">Social</option>
                            <option value="Governance">Governance</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="questionOptions">Options (one per line):</label>
                        <textarea id="questionOptions" name="options" class="form-control" rows="4" required placeholder="Yes&#10;No&#10;In development&#10;Not applicable"></textarea>
                    </div>
                    
                    <button type="submit" class="btn-add">
                        <i class="fas fa-plus"></i> Add Question
                    </button>
                </form>
            </div>

            <!-- Question Tabs -->
            <div class="questions-section">
                <h2 style="color: #065f46; margin-bottom: 1.5rem;">
                    <i class="fas fa-list"></i> Existing Questions
                </h2>
                
                <div class="question-tabs">
                    <button class="tab-button active" onclick="showTab('general', this)">
                        <i class="fas fa-globe"></i> General Questions
                    </button>
                    <button class="tab-button" onclick="showTab('textile', this)">
                        <i class="fas fa-tshirt"></i> Textile
                    </button>
                    <button class="tab-button" onclick="showTab('chemicals', this)">
                        <i class="fas fa-flask"></i> Chemicals
                    </button>
                    <button class="tab-button" onclick="showTab('pharmaceuticals', this)">
                        <i class="fas fa-pills"></i> Pharmaceuticals
                    </button>
                    <button class="tab-button" onclick="showTab('automobile', this)">
                        <i class="fas fa-car"></i> Automobile
                    </button>
                    <button class="tab-button" onclick="showTab('manufacturing', this)">
                        <i class="fas fa-industry"></i> Manufacturing
                    </button>
                    <button class="tab-button" onclick="showTab('construction', this)">
                        <i class="fas fa-hard-hat"></i> Construction
                    </button>
                    <button class="tab-button" onclick="showTab('energy', this)">
                        <i class="fas fa-bolt"></i> Energy
                    </button>
                    <button class="tab-button" onclick="showTab('technology', this)">
                        <i class="fas fa-laptop"></i> Technology
                    </button>
                    <button class="tab-button" onclick="showTab('healthcare', this)">
                        <i class="fas fa-heartbeat"></i> Healthcare
                    </button>
                    <button class="tab-button" onclick="showTab('finance', this)">
                        <i class="fas fa-university"></i> Finance
                    </button>
                    <button class="tab-button" onclick="showTab('retail', this)">
                        <i class="fas fa-shopping-cart"></i> Retail
                    </button>
                    <button class="tab-button" onclick="showTab('agriculture', this)">
                        <i class="fas fa-seedling"></i> Agriculture
                    </button>
                    <button class="tab-button" onclick="showTab('education', this)">
                        <i class="fas fa-graduation-cap"></i> Education
                    </button>
                    <button class="tab-button" onclick="showTab('others', this)">
                        <i class="fas fa-ellipsis-h"></i> Others
                    </button>
                </div>

                <!-- General Questions Tab -->
                <div id="general" class="tab-content active">
                    <% if (generalQuestions && generalQuestions.length > 0) { %>
                        <% generalQuestions.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('general', '<%= question.id %>')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('general', null, '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-list"></i> <%= question.type %></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-question-circle" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No general questions found. Add some questions to get started.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Manufacturing Questions Tab -->
                <div id="manufacturing" class="tab-content">
                    <% if (industryQuestions && industryQuestions.manufacturing && industryQuestions.manufacturing.length > 0) { %>
                        <% industryQuestions.manufacturing.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'manufacturing')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'manufacturing', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-industry"></i> Manufacturing</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-industry" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No manufacturing questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Technology Questions Tab -->
                <div id="technology" class="tab-content">
                    <% if (industryQuestions && industryQuestions.technology && industryQuestions.technology.length > 0) { %>
                        <% industryQuestions.technology.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'technology')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'technology', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-laptop"></i> Technology</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-laptop" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No technology questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Textile Questions Tab -->
                <div id="textile" class="tab-content">
                    <% if (industryQuestions && industryQuestions.textile && industryQuestions.textile.length > 0) { %>
                        <% industryQuestions.textile.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'textile')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'textile', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-tshirt"></i> Textile</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-tshirt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No textile questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Chemicals Questions Tab -->
                <div id="chemicals" class="tab-content">
                    <% if (industryQuestions && industryQuestions.chemicals && industryQuestions.chemicals.length > 0) { %>
                        <% industryQuestions.chemicals.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'chemicals')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'chemicals', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-flask"></i> Chemicals</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-flask" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No chemicals questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Pharmaceuticals Questions Tab -->
                <div id="pharmaceuticals" class="tab-content">
                    <% if (industryQuestions && industryQuestions.pharmaceuticals && industryQuestions.pharmaceuticals.length > 0) { %>
                        <% industryQuestions.pharmaceuticals.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'pharmaceuticals')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'pharmaceuticals', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-pills"></i> Pharmaceuticals</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-pills" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No pharmaceuticals questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Automobile Questions Tab -->
                <div id="automobile" class="tab-content">
                    <% if (industryQuestions && industryQuestions.automobile && industryQuestions.automobile.length > 0) { %>
                        <% industryQuestions.automobile.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'automobile')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'automobile', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-car"></i> Automobile</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-car" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No automobile questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Construction Questions Tab -->
                <div id="construction" class="tab-content">
                    <% if (industryQuestions && industryQuestions.construction && industryQuestions.construction.length > 0) { %>
                        <% industryQuestions.construction.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'construction')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'construction', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-hard-hat"></i> Construction</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-hard-hat" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No construction questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Energy Questions Tab -->
                <div id="energy" class="tab-content">
                    <% if (industryQuestions && industryQuestions.energy && industryQuestions.energy.length > 0) { %>
                        <% industryQuestions.energy.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'energy')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'energy', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-bolt"></i> Energy</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-bolt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No energy questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Agriculture Questions Tab -->
                <div id="agriculture" class="tab-content">
                    <% if (industryQuestions && industryQuestions.agriculture && industryQuestions.agriculture.length > 0) { %>
                        <% industryQuestions.agriculture.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'agriculture')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'agriculture', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-seedling"></i> Agriculture</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-seedling" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No agriculture questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Retail Questions Tab -->
                <div id="retail" class="tab-content">
                    <% if (industryQuestions && industryQuestions.retail && industryQuestions.retail.length > 0) { %>
                        <% industryQuestions.retail.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'retail')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'retail', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-shopping-cart"></i> Retail</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-shopping-cart" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No retail questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Finance Questions Tab -->
                <div id="finance" class="tab-content">
                    <% if (industryQuestions && industryQuestions.finance && industryQuestions.finance.length > 0) { %>
                        <% industryQuestions.finance.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'finance')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'finance', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-university"></i> Finance</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-university" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No finance questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Healthcare Questions Tab -->
                <div id="healthcare" class="tab-content">
                    <% if (industryQuestions && industryQuestions.healthcare && industryQuestions.healthcare.length > 0) { %>
                        <% industryQuestions.healthcare.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'healthcare')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'healthcare', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-heartbeat"></i> Healthcare</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-heartbeat" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No healthcare questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Education Questions Tab -->
                <div id="education" class="tab-content">
                    <% if (industryQuestions && industryQuestions.education && industryQuestions.education.length > 0) { %>
                        <% industryQuestions.education.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'education')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'education', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-graduation-cap"></i> Education</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-graduation-cap" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No education questions found.</p>
                        </div>
                    <% } %>
                </div>

                <!-- Others Questions Tab -->
                <div id="others" class="tab-content">
                    <% if (industryQuestions && industryQuestions.others && industryQuestions.others.length > 0) { %>
                        <% industryQuestions.others.forEach(question => { %>
                            <div class="question-item">
                                <div class="question-actions">
                                    <button class="btn-action btn-edit" onclick="editQuestion('industry', '<%= question.id %>', 'others')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-action btn-delete" onclick="deleteQuestion('industry', 'others', '<%= question.id %>')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                
                                <div class="question-header">
                                    <span class="question-id"><%= question.id %></span>
                                    <div class="flex-1">
                                        <div class="question-text"><%= question.question %></div>
                                        <div class="question-meta">
                                            <span><i class="fas fa-tag"></i> <%= question.category %></span>
                                            <span><i class="fas fa-ellipsis-h"></i> Others</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <% if (question.options && question.options.length > 0) { %>
                                    <div class="question-options">
                                        <strong>Options:</strong>
                                        <% question.options.forEach(option => { %>
                                            <div class="option-item">• <%= option %></div>
                                        <% }); %>
                                    </div>
                                <% } %>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <i class="fas fa-ellipsis-h" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No other industry questions found.</p>
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Tab functionality
        function showTab(tabName, clickedElement) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            const targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            // Add active class to clicked button
            if (clickedElement) {
                clickedElement.classList.add('active');
            } else if (window.event && window.event.target) {
                window.event.target.classList.add('active');
            }
        }

        // Question type change handler
        document.getElementById('questionType').addEventListener('change', function() {
            const industryGroup = document.getElementById('industryGroup');
            if (this.value === 'industry') {
                industryGroup.style.display = 'block';
                document.getElementById('industry').required = true;
            } else {
                industryGroup.style.display = 'none';
                document.getElementById('industry').required = false;
            }
        });

        // Add question form submission
        document.getElementById('addQuestionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const questionData = {
                question: formData.get('question'),
                type: 'multiple-choice',
                options: formData.get('options').split('\n').filter(opt => opt.trim()),
                category: formData.get('category')
            };
            
            try {
                const response = await fetch('/admin/questions/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        type: formData.get('type'),
                        industry: formData.get('industry'),
                        question: questionData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('Question added successfully!', 'success');
                    this.reset();
                    setTimeout(() => location.reload(), 1500);
                } else {
                    showAlert('Error adding question: ' + result.error, 'error');
                }
            } catch (error) {
                showAlert('Error adding question: ' + error.message, 'error');
            }
        });

        // Delete question function
        async function deleteQuestion(type, industry, questionId) {
            if (!confirm('Are you sure you want to delete this question?')) {
                return;
            }
            
            try {
                let url = `/admin/questions/${type}/${questionId}`;
                if (industry) {
                    url = `/admin/questions/industry/${industry}/${questionId}`;
                }
                
                const response = await fetch(url, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('Question deleted successfully!', 'success');
                    setTimeout(() => location.reload(), 1000);
                } else {
                    showAlert('Error deleting question: ' + result.error, 'error');
                }
            } catch (error) {
                showAlert('Error deleting question: ' + error.message, 'error');
            }
        }

        // Edit question function
        function editQuestion(type, questionId, industry) {
            // First, find the question data
            let questionData = null;
            let endpoint = '';
            
            if (type === 'general') {
                // Find in general questions
                const generalQuestions = <%- JSON.stringify(generalQuestions || []) %>;
                questionData = generalQuestions.find(q => q.id === questionId);
                endpoint = `/admin/questions/general/${questionId}`;
            } else if (type === 'industry') {
                // Find in industry questions
                const industryQuestions = <%- JSON.stringify(industryQuestions || {}) %>;
                if (industryQuestions[industry]) {
                    questionData = industryQuestions[industry].find(q => q.id === questionId);
                }
                endpoint = `/admin/questions/industry/${industry}/${questionId}`;
            }
            
            if (!questionData) {
                showAlert('Question not found!', 'error');
                return;
            }
            
            // Create edit modal
            const modalHtml = `
                <div id="editModal" class="modal-overlay" style="display: flex;" onclick="closeEditModal(event)">
                    <div class="modal-content" style="max-width: 600px; width: 90%;" onclick="event.stopPropagation();">
                        <div class="modal-header">
                            <h3><i class="fas fa-edit"></i> Edit Question</h3>
                            <button class="modal-close" onclick="closeEditModal()">&times;</button>
                        </div>
                        <form id="editQuestionForm" onsubmit="updateQuestion(event, '${type}', '${questionId}', '${industry || ''}')">
                            <div class="form-group">
                                <label>Question ID</label>
                                <input type="text" value="${questionData.id}" readonly style="background: #f8f9fa;">
                            </div>
                            <div class="form-group">
                                <label>Question Text *</label>
                                <textarea name="question" required style="min-height: 80px;">${questionData.question}</textarea>
                            </div>
                            <div class="form-group">
                                <label>Category *</label>
                                <select name="category" required>
                                    <option value="Environmental" ${questionData.category === 'Environmental' ? 'selected' : ''}>Environmental</option>
                                    <option value="Social" ${questionData.category === 'Social' ? 'selected' : ''}>Social</option>
                                    <option value="Governance" ${questionData.category === 'Governance' ? 'selected' : ''}>Governance</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Question Type</label>
                                <select name="type">
                                    <option value="multiple-choice" ${questionData.type === 'multiple-choice' ? 'selected' : ''}>Multiple Choice</option>
                                    <option value="text" ${questionData.type === 'text' ? 'selected' : ''}>Text</option>
                                    <option value="yes-no" ${questionData.type === 'yes-no' ? 'selected' : ''}>Yes/No</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Options (one per line, for multiple-choice questions)</label>
                                <textarea name="options" rows="4" placeholder="Option 1\nOption 2\nOption 3">${questionData.options ? questionData.options.join('\n') : ''}</textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Update Question
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }
        
        // Close edit modal
        function closeEditModal(event) {
            // Only close if clicking on overlay or close button, not on modal content
            if (!event || event.target.classList.contains('modal-overlay') || event.target.classList.contains('modal-close')) {
                const modal = document.getElementById('editModal');
                if (modal) {
                    modal.remove();
                }
            }
        }
        
        // Update question
        async function updateQuestion(event, type, questionId, industry) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const questionData = {
                question: formData.get('question'),
                category: formData.get('category'),
                type: formData.get('type'),
                options: formData.get('options') ? formData.get('options').split('\n').filter(opt => opt.trim()) : []
            };
            
            try {
                let endpoint = '';
                if (type === 'general') {
                    endpoint = `/admin/questions/general/${questionId}`;
                } else if (type === 'industry') {
                    endpoint = `/admin/questions/industry/${industry}/${questionId}`;
                }
                
                const response = await fetch(endpoint, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(questionData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('Question updated successfully!', 'success');
                    closeEditModal();
                    // Reload the page to show updated data
                    setTimeout(() => {
                        window.location.reload();
                    }, 1500);
                } else {
                    showAlert('Error updating question: ' + result.error, 'error');
                }
            } catch (error) {
                showAlert('Error updating question: ' + error.message, 'error');
            }
        }

        // Show alert function
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
            
            alertContainer.innerHTML = `
                <div class="alert ${alertClass}">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                alertContainer.innerHTML = '';
            }, 5000);
        }
    </script>
</body>
</html>
